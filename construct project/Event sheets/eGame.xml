<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>eGame</name>
    <events>
        <variable constant="0" name="level" sid="478856130997259" static="0" type="number">1</variable>
        <variable constant="0" name="nbLights" sid="551270629813574" static="0" type="number">0</variable>
        <variable constant="0" name="winState" sid="983866056576056" static="0" type="text">false</variable>
        <variable comment="in seconds" constant="0" name="delay" sid="233878733708793" static="0" type="number">300</variable>
        <variable constant="0" name="workfolder" sid="372749836834010" static="0" type="text"></variable>
        <variable constant="1" name="json_filename" sid="439621911725426" static="0" type="text">data.json</variable>
        <variable constant="1" name="LOG_FILENAME" sid="217482923794249" static="0" type="text">log construct.txt</variable>
        <variable constant="1" name="png_filename" sid="327046001471604" static="0" type="text">screenshot.png</variable>
        <event-group description="" sid="940768003895520" title="Load config.json">
            <sub-events>
                <event-block sid="397831868162303">
                    <conditions>
                        <condition id="-2" name="On start of layout" sid="143127422393697" type="System" />
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="501687986175162" type="Function">
                            <param id="0" name="Name">&quot;log&quot;</param>
                            <param id="1" name="Parameter {n}">&quot;Platform: &quot; &amp; Browser.Platform</param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="391372763882195">
                            <conditions>
                                <condition id="-18" name="Is in preview" sid="874713942747914" type="System" />
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="426297559136655" type="System">
                                    <param id="0" name="Variable">workfolder</param>
                                    <param id="1" name="Value">&quot;C:\Users\narF\Documents\github\bot-discord\bin\&quot;</param>
                                </action>
                                <action id="0" name="Call function" sid="683412461303481" type="Function">
                                    <param id="0" name="Name">&quot;mainScript&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="153425098908382">
                            <conditions>
                                <condition id="-22" name="Else" sid="173496804694693" type="System" />
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="101144897075582">
                                    <conditions>
                                        <condition id="-8" name="Compare two values" sid="102574990181549" type="System">
                                            <param id="0" name="First value">Browser.Platform</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Second value">&quot;Win32&quot;</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="948981221955321" type="System">
                                            <param id="0" name="Variable">workfolder</param>
                                            <param id="1" name="Value">NWjs.AppFolder</param>
                                        </action>
                                        <action id="0" name="Call function" sid="416443065436050" type="Function">
                                            <param id="0" name="Name">&quot;mainScript&quot;</param>
                                            <param id="1" name="Parameter {n}"></param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>else: mac</comment>
                                <event-block sid="410195878259451">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="426704051578094" type="System" />
                                        <condition id="-8" name="Compare two values" sid="883512864145372" type="System">
                                            <param id="0" name="First value">Browser.Platform</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Second value">&quot;MacIntel&quot;</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="1" name="Request project file" sid="358264459284756" type="AJAX">
                                            <param id="0" name="Tag">&quot;config.json&quot;</param>
                                            <param id="1" name="File">config.json</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>else: I don&apos;t know!</comment>
                                <event-block sid="150478682611096">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="696530714998778" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="0" name="Call function" sid="583095505000816" type="Function">
                                            <param id="0" name="Name">&quot;log&quot;</param>
                                            <param id="1" name="Parameter {n}">&quot;I don&apos;t understand what this platform is!&quot;</param>
                                        </action>
                                        <action id="-9" name="Set value" sid="121855690790799" type="System">
                                            <param id="0" name="Variable">workfolder</param>
                                            <param id="1" name="Value">NWjs.AppFolder</param>
                                        </action>
                                        <action id="0" name="Call function" sid="713444944651698" type="Function">
                                            <param id="0" name="Name">&quot;mainScript&quot;</param>
                                            <param id="1" name="Parameter {n}"></param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="735629405522881">
                    <conditions>
                        <condition id="0" name="On completed" sid="904863649084337" type="AJAX">
                            <param id="0" name="Tag">&quot;config.json&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="60" name="LoadJSON" sid="442941668086037" type="config">
                            <param id="0" name="JSON">AJAX.LastData</param>
                            <param id="1" name="Reference point">0</param>
                            <param id="2" name="Key {n}"></param>
                        </action>
                        <action id="-9" name="Set value" sid="174413214845218" type="System">
                            <param id="0" name="Variable">workfolder</param>
                            <param id="1" name="Value">config.Value(0, &quot;path&quot;)</param>
                        </action>
                        <action id="0" name="Call function" sid="434232492071817" type="Function">
                            <param id="0" name="Name">&quot;mainScript&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="910290590643327">
                    <conditions>
                        <condition id="1" name="On error" sid="182992698518274" type="AJAX">
                            <param id="0" name="Tag">&quot;config.json&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="866024900269074" type="Function">
                            <param id="0" name="Name">&quot;log&quot;</param>
                            <param id="1" name="Parameter {n}">&quot;Could not load config.json&quot;</param>
                        </action>
                        <action id="0" name="Call function" sid="838386174682300" type="Function">
                            <param id="0" name="Name">&quot;exit&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="585566149608349" title="main script">
            <sub-events>
                <event-block sid="428664085259921">
                    <conditions>
                        <condition id="0" name="On function" sid="219681270000616" type="Function">
                            <param id="0" name="Name">&quot;mainScript&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="573268769594515" type="Function">
                            <param id="0" name="Name">&quot;log&quot;</param>
                            <param id="1" name="Parameter {n}">&quot;workfolder &quot; &amp; workfolder</param>
                        </action>
                        <action id="0" name="Call function" sid="689383315290107" type="Function">
                            <param id="0" name="Name">&quot;json.initialize&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                        <action id="0" name="Call function" sid="949591608103614" type="Function">
                            <param id="0" name="Name">&quot;level.generate&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                        <action id="-16" name="Wait" sid="630390679604347" type="System">
                            <param id="0" name="Seconds">0</param>
                        </action>
                        <action id="0" name="Call function" sid="994071195774813" type="Function">
                            <param id="0" name="Name">&quot;enlight&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                        <action disabled="1" id="-16" name="Wait" sid="182740710206965" type="System">
                            <param id="0" name="Seconds">1</param>
                        </action>
                        <action id="0" name="Call function" sid="626425976055284" type="Function">
                            <param id="0" name="Name">&quot;screenshot&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="328947965655543">
                    <conditions>
                        <condition id="0" name="On function" sid="386280364739540" type="Function">
                            <param id="0" name="Name">&quot;exit&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="158561494617772" type="Function">
                            <param id="0" name="Name">&quot;log&quot;</param>
                            <param id="1" name="Parameter {n}">&quot;close&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="521820988015998">
                            <conditions>
                                <condition id="-18" inverted="1" name="Is in preview" sid="688484125188679" type="System" />
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="895441752089679" type="Function">
                                    <param id="0" name="Name">&quot;log.save&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                                <action disabled="1" id="-16" name="Wait" sid="381289750714780" type="System">
                                    <param id="0" name="Seconds">10</param>
                                </action>
                                <action id="1" name="Close" sid="472457383851585" type="Browser" />
                            </actions>
                        </event-block>
                        <event-block sid="764798628557851">
                            <conditions>
                                <condition id="-22" name="Else" sid="529100524324020" type="System" />
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="562662393157310" type="Function">
                                    <param id="0" name="Name">&quot;log&quot;</param>
                                    <param id="1" name="Parameter {n}">&quot;lol nope, not closing cause i&apos;m in preview&quot;</param>
                                </action>
                                <action id="0" name="Call function" sid="389641698413180" type="Function">
                                    <param id="0" name="Name">&quot;log.save&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="886505775072728" title="data.json">
            <sub-events>
                <event-block sid="588738474569913">
                    <conditions>
                        <condition id="0" name="On function" sid="676957811868607" type="Function">
                            <param id="0" name="Name">&quot;json.initialize&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="802986212209201" type="Function">
                            <param id="0" name="Name">&quot;log&quot;</param>
                            <param id="1" name="Parameter {n}">&quot;function json.initialize: &quot; &amp; workfolder&amp;JSON_FILENAME</param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="341197442409884">
                            <conditions>
                                <condition id="0" name="Path exists" sid="322552423265164" type="NWjs">
                                    <param id="0" name="Path">workfolder&amp;JSON_FILENAME</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="60" name="LoadJSON" sid="497275153891927" type="data">
                                    <param id="0" name="JSON">NWjs.ReadFile(workfolder &amp; JSON_FILENAME)</param>
                                    <param id="1" name="Reference point">0</param>
                                    <param id="2" name="Key {n}"></param>
                                </action>
                                <action id="0" name="Call function" sid="301597753395746" type="Function">
                                    <param id="0" name="Name">&quot;log&quot;</param>
                                    <param id="1" name="Parameter {n}">data.AsJson(0)</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block sid="362715330394910">
                                    <conditions>
                                        <condition id="70" inverted="1" name="Is Empty" sid="386403815168163" type="data">
                                            <param id="0" name="Reference point">0</param>
                                            <param id="1" name="Key {n}"></param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="904356852568936" type="System">
                                            <param id="0" name="Variable">level</param>
                                            <param id="1" name="Value">Function.Call(&quot;json.getlevel&quot;)</param>
                                        </action>
                                        <action id="0" name="Call function" sid="297825495085252" type="Function">
                                            <param id="0" name="Name">&quot;log&quot;</param>
                                            <param id="1" name="Parameter {n}">&quot;level: &quot; &amp; level</param>
                                        </action>
                                    </actions>
                                    <sub-events>
                                        <event-block sid="230224293854172">
                                            <conditions>
                                                <condition id="-37" name="Is number NaN" sid="206414124254418" type="System">
                                                    <param id="0" name="Number">level</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="0" name="Call function" sid="495073198347096" type="Function">
                                                    <param id="0" name="Name">&quot;log&quot;</param>
                                                    <param id="1" name="Parameter {n}">&quot;level was NaN, so we set it to 1&quot;</param>
                                                </action>
                                                <action id="-9" name="Set value" sid="296044918629559" type="System">
                                                    <param id="0" name="Variable">level</param>
                                                    <param id="1" name="Value">1</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                                <event-block sid="638991445686216">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="503054442519407" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="0" name="Call function" sid="494568025779957" type="Function">
                                            <param id="0" name="Name">&quot;log&quot;</param>
                                            <param id="1" name="Parameter {n}">&quot;JSON was empty, so level was set to 1&quot;</param>
                                        </action>
                                        <action id="-9" name="Set value" sid="253088312028075" type="System">
                                            <param id="0" name="Variable">level</param>
                                            <param id="1" name="Value">1</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="109235892180129">
                            <conditions>
                                <condition id="-22" name="Else" sid="860630259261369" type="System" />
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="482642029888979" type="Function">
                                    <param id="0" name="Name">&quot;log&quot;</param>
                                    <param id="1" name="Parameter {n}">&quot;Path doesn&apos;t exist: &quot; &amp; workfolder&amp;JSON_FILENAME</param>
                                </action>
                                <action id="0" name="Call function" sid="923238907844843" type="Function">
                                    <param id="0" name="Name">&quot;exit&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="487340268699013">
                    <conditions>
                        <condition id="0" name="On function" sid="859603123839871" type="Function">
                            <param id="0" name="Name">&quot;json.getlevel&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="1" name="Set return value" sid="760372225409570" type="Function">
                            <param id="0" name="Value">data.Value(0, &quot;level&quot;)</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="224562211939668">
                    <conditions>
                        <condition id="0" name="On function" sid="577008761327436" type="Function">
                            <param id="0" name="Name">&quot;json.setWinState&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="547654892933486">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="170499719500333" type="System">
                                    <param id="0" name="Variable">winState</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;true&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="20" name="Set Value" sid="423456062545797" type="data">
                                    <param id="0" name="Value">1</param>
                                    <param id="1" name="Reference point">0</param>
                                    <param id="2" name="Key {n}">&quot;win&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="108825887673401">
                            <conditions>
                                <condition id="-22" name="Else" sid="323390790313897" type="System" />
                            </conditions>
                            <actions>
                                <action id="20" name="Set Value" sid="488122052196993" type="data">
                                    <param id="0" name="Value">0</param>
                                    <param id="1" name="Reference point">0</param>
                                    <param id="2" name="Key {n}">&quot;win&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="352493687113611">
                            <conditions />
                            <actions>
                                <action id="0" name="Write file" sid="837337624271072" type="NWjs">
                                    <param id="0" name="Path">workfolder&amp;JSON_FILENAME</param>
                                    <param id="1" name="Contents">data.AsJson(0)</param>
                                </action>
                                <action id="0" name="Call function" sid="755768776549368" type="Function">
                                    <param id="0" name="Name">&quot;log&quot;</param>
                                    <param id="1" name="Parameter {n}">&quot;Write &quot;&amp;data.AsJson(0)&amp;&quot; into &quot; &amp;workfolder&amp;JSON_FILENAME</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>outputError is not called currently...</comment>
                <event-block sid="148861231589872">
                    <conditions>
                        <condition id="0" name="On function" sid="936330001890679" type="Function">
                            <param id="0" name="Name">&quot;json.outputError&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="40" name="Set null" sid="616331933075428" type="data">
                            <param id="0" name="Reference point">0</param>
                            <param id="1" name="Key {n}"></param>
                        </action>
                        <action id="20" name="Set Value" sid="628111265096123" type="data">
                            <param id="0" name="Value">&quot;error&quot;</param>
                            <param id="1" name="Reference point">0</param>
                            <param id="2" name="Key {n}">&quot;error&quot;</param>
                        </action>
                        <action id="0" name="Write file" sid="256891947760589" type="NWjs">
                            <param id="0" name="Path">workfolder&amp;JSON_FILENAME</param>
                            <param id="1" name="Contents">data.AsJson(0)</param>
                        </action>
                        <action id="0" name="Call function" sid="247095861321195" type="Function">
                            <param id="0" name="Name">&quot;log&quot;</param>
                            <param id="1" name="Parameter {n}">&quot;json.outputError: &quot; &amp; data.AsJson(0)</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="816798565725370" title="generate grid">
            <sub-events>
                <variable constant="0" name="x" sid="365903226918475" static="0" type="number">0</variable>
                <variable constant="0" name="y" sid="747858400935235" static="0" type="number">0</variable>
                <variable constant="0" name="size" sid="970516920696068" static="0" type="number">0</variable>
                <event-block sid="246950208867850">
                    <conditions>
                        <condition id="0" name="On function" sid="149315705394105" type="Function">
                            <param id="0" name="Name">&quot;level.generate&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-9" name="Destroy" sid="318976466640531" type="light" />
                        <action id="-9" name="Set value" sid="840851653702096" type="System">
                            <param id="0" name="Variable">x</param>
                            <param id="1" name="Value">level+1</param>
                        </action>
                        <action id="-9" name="Set value" sid="496240791169466" type="System">
                            <param id="0" name="Variable">y</param>
                            <param id="1" name="Value">level+1</param>
                        </action>
                        <action id="-9" name="Set value" sid="264019652708712" type="System">
                            <param id="0" name="Variable">size</param>
                            <param id="1" name="Value">OriginalWindowHeight/x</param>
                        </action>
                        <action id="14" name="Log" sid="596582483258609" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;level.generate: size &quot;&amp;x&amp;&quot;x&quot;&amp;y</param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="922158798761109">
                            <conditions>
                                <condition id="-10" name="For" sid="958384551825001" type="System">
                                    <param id="0" name="Name">&quot;y&quot;</param>
                                    <param id="1" name="Start index">0</param>
                                    <param id="2" name="End index">y-1</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="645109774531330">
                                    <conditions>
                                        <condition id="-10" name="For" sid="763422974097763" type="System">
                                            <param id="0" name="Name">&quot;x&quot;</param>
                                            <param id="1" name="Start index">0</param>
                                            <param id="2" name="End index">x-1</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-3" name="Create object" sid="751459908655833" type="System">
                                            <param id="0" name="Object to create">light</param>
                                            <param id="1" name="Layer">&quot;game&quot;</param>
                                            <param id="2" name="X">loopindex(&quot;x&quot;) * size + (size/2)</param>
                                            <param id="3" name="Y">loopindex(&quot;y&quot;) * size + (size/2)</param>
                                        </action>
                                        <action id="-7" name="Set size" sid="216169088755776" type="light">
                                            <param id="0" name="Width">size</param>
                                            <param id="1" name="Height">size</param>
                                        </action>
                                        <action id="-13" name="Set boolean" sid="714460748194628" type="light">
                                            <param id="0" name="Instance variable">on</param>
                                            <param id="1" name="Value">0</param>
                                        </action>
                                        <action id="-16" name="Set opacity" sid="153673772313058" type="light">
                                            <param id="0" name="Opacity">0</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="724920452772427">
                            <conditions />
                            <actions>
                                <action id="0" name="Call function" sid="394548837887271" type="Function">
                                    <param id="0" name="Name">&quot;change colors&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="819531206651458" title="lights">
            <sub-events>
                <comment>roll dices</comment>
                <event-block sid="169326333768904">
                    <conditions>
                        <condition id="0" name="On function" sid="741269014733341" type="Function">
                            <param id="0" name="Name">&quot;enlight&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="257990888311496" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;enlight!&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="roll" sid="567918534823691" static="0" type="number">0</variable>
                        <variable constant="0" name="rollMax" sid="469729841890665" static="0" type="number">0</variable>
                        <variable constant="0" name="lights" sid="155693386529601" static="0" type="number">0</variable>
                        <event-block sid="145475981854245">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="193924629158231" type="System">
                                    <param id="0" name="Variable">rollMax</param>
                                    <param id="1" name="Value">ceil(level+(3/level)-1)</param>
                                </action>
                                <action id="0" name="Call function" sid="336715454971486" type="Function">
                                    <param id="0" name="Name">&quot;log&quot;</param>
                                    <param id="1" name="Parameter {n}">&quot;rollMax: &quot; &amp; rollMax</param>
                                </action>
                                <action id="-9" name="Set value" sid="125385485535513" type="System">
                                    <param id="0" name="Variable">roll</param>
                                    <param id="1" name="Value">ceil(random(0.000001, rollMax))</param>
                                </action>
                                <action id="0" name="Call function" sid="406384620158779" type="Function">
                                    <param id="0" name="Name">&quot;log&quot;</param>
                                    <param id="1" name="Parameter {n}">&quot;roll: &quot; &amp; roll</param>
                                </action>
                                <action id="-9" name="Set value" sid="599709453325694" type="System">
                                    <param id="0" name="Variable">lights</param>
                                    <param id="1" name="Value">ceil( roll/rollMax * light.PickedCount )</param>
                                </action>
                                <action id="0" name="Call function" sid="630717905509738" type="Function">
                                    <param id="0" name="Name">&quot;log&quot;</param>
                                    <param id="1" name="Parameter {n}">&quot;lights: &quot;&amp;lights&amp;&quot;/&quot;&amp;light.PickedCount</param>
                                </action>
                                <action id="-9" name="Set value" sid="569670656564407" type="System">
                                    <param id="0" name="Variable">nbLights</param>
                                    <param id="1" name="Value">lights</param>
                                </action>
                                <action id="0" name="Call function" sid="841831748820212" type="Function">
                                    <param id="0" name="Name">&quot;light n&quot;</param>
                                    <param id="1" name="Parameter {n}">lights</param>
                                </action>
                                <action id="-9" name="Set value" sid="754946603284248" type="System">
                                    <param id="0" name="Variable">winState</param>
                                    <param id="1" name="Value">Function.Call(&quot;has won&quot;)</param>
                                </action>
                                <action id="0" name="Call function" sid="534021239553272" type="Function">
                                    <param id="0" name="Name">&quot;log&quot;</param>
                                    <param id="1" name="Parameter {n}">&quot;win: &quot; &amp; winState</param>
                                </action>
                                <action id="0" name="Call function" sid="269252653437648" type="Function">
                                    <param id="0" name="Name">&quot;json.setWinState&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>return true if the game is in win state</comment>
                <comment>take a number of lights in parameter. Return true if that number is equal to the total nb of lights.</comment>
                <event-block sid="429084115795183">
                    <conditions>
                        <condition id="0" name="On function" sid="275270093529661" type="Function">
                            <param id="0" name="Name">&quot;has won&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="379945932628718" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function: has won?&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="n" sid="268263257155258" static="0" type="number">0</variable>
                        <event-block sid="452155956749623">
                            <conditions>
                                <condition id="-8" name="Compare two values" sid="801377690010241" type="System">
                                    <param id="0" name="First value">Function.ParamCount</param>
                                    <param id="1" name="Comparison">4</param>
                                    <param id="2" name="Second value">0</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="225493463312787" type="System">
                                    <param id="0" name="Variable">n</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="270652860684174">
                            <conditions>
                                <condition id="-22" name="Else" sid="858530381940543" type="System" />
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="846309396454750" type="System">
                                    <param id="0" name="Variable">n</param>
                                    <param id="1" name="Value">nbLights</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="500542760732277">
                            <conditions>
                                <condition id="-8" name="Compare two values" sid="180347183624624" type="System">
                                    <param id="0" name="First value">n</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">(level+1)^2</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="1" name="Set return value" sid="637729034923474" type="Function">
                                    <param id="0" name="Value">&quot;true&quot;</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="485282337776202" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;has won? &quot; &amp; n &amp; &quot;: true&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="202988890689386">
                            <conditions>
                                <condition id="-22" name="Else" sid="924675268328590" type="System" />
                            </conditions>
                            <actions>
                                <action id="1" name="Set return value" sid="584626804631124" type="Function">
                                    <param id="0" name="Value">&quot;false&quot;</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="704754950681419" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;has won? &quot; &amp; n &amp; &quot;: false&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="481327515003918">
                    <conditions>
                        <condition id="0" name="On function" sid="248267759410255" type="Function">
                            <param id="0" name="Name">&quot;light n&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="565235981338103" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function call: light n&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="n" sid="700636243393481" static="0" type="number">0</variable>
                        <event-block sid="494315483192934">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="822244845848261" type="System">
                                    <param id="0" name="Variable">n</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="423428741579059">
                            <conditions />
                            <actions>
                                <action id="-13" name="Set boolean" sid="631649183414760" type="light">
                                    <param id="0" name="Instance variable">on</param>
                                    <param id="1" name="Value">0</param>
                                </action>
                                <action id="-16" name="Set opacity" sid="514814453697814" type="light">
                                    <param id="0" name="Opacity">0</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="833845341272904" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;total nb cells: &quot; &amp; light.PickedCount</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="956088296242526">
                            <conditions>
                                <condition id="-12" name="Repeat" sid="922982753352162" type="System">
                                    <param id="0" name="Count">n</param>
                                </condition>
                                <condition id="-8" inverted="1" name="Is boolean instance variable set" sid="176537849534695" type="light">
                                    <param id="0" name="Instance variable">on</param>
                                </condition>
                                <condition id="-16" name="Pick random instance" sid="406353246125332" type="System">
                                    <param id="0" name="Object">light</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-13" name="Set boolean" sid="541180163616238" type="light">
                                    <param id="0" name="Instance variable">on</param>
                                    <param id="1" name="Value">1</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="486926440244540" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;1 light (&quot; &amp; light.UID &amp; &quot;)&quot;</param>
                                </action>
                                <action id="-16" name="Set opacity" sid="935232486727433" type="light">
                                    <param id="0" name="Opacity">100</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>Fait briller les lumières quand on a gagné</comment>
                <event-block sid="637800833803050">
                    <conditions>
                        <condition id="-14" name="Compare variable" sid="761681920954309" type="System">
                            <param id="0" name="Variable">winState</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Value">&quot;true&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-16" name="Set opacity" sid="439776325522175" type="light">
                            <param id="0" name="Opacity">random(40, 100)</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="950583573564162" title="screenshot">
            <sub-events>
                <event-block sid="456839249689286">
                    <conditions>
                        <condition id="0" name="On function" sid="489432736956070" type="Function">
                            <param id="0" name="Name">&quot;screenshot&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-27" name="Snapshot canvas" sid="611134012398338" type="System">
                            <param id="0" name="Format">0</param>
                            <param id="1" name="JPEG quality">100</param>
                        </action>
                    </actions>
                </event-block>
                <variable comment="1=true" constant="0" name="done" sid="266964088013177" static="1" type="number">0</variable>
                <event-block sid="886737896096347">
                    <conditions>
                        <condition id="-26" name="On canvas snapshot" sid="815919344209193" type="System" />
                    </conditions>
                    <actions>
                        <action disabled="1" id="0" name="Write file" sid="209817338206823" type="NWjs">
                            <param id="0" name="Path">NWjs.UserFolder &amp; &quot;Desktop\img.png&quot;</param>
                            <param id="1" name="Contents">Browser.ExecJS(&quot;atob(&quot;&quot;&quot; &amp; tokenat(CanvasSnapshot, 1, &quot;,&quot;) &amp; &quot;&quot;&quot;)&quot;)</param>
                        </action>
                        <action id="17" name="Execute Javascript" sid="984983615080600" type="Browser">
                            <param id="0" name="Javascript">&quot;var fs = require(&apos;fs&apos;);fs[&apos;writeFileSync&apos;](&apos;&quot; &amp;replace(workfolder &amp; PNG_FILENAME,&quot;\&quot;,&quot;\\&quot;)&amp; &quot;&apos;,&apos;&quot; &amp;CanvasSnapshot&amp; &quot;&apos;.split(&apos;,&apos;)[1], {&apos;encoding&apos;: &apos;base64&apos;});&quot;</param>
                        </action>
                        <action id="0" name="Call function" sid="790694484336978" type="Function">
                            <param id="0" name="Name">&quot;log&quot;</param>
                            <param id="1" name="Parameter {n}">&quot;Export screenshot: &quot; &amp; workfolder &amp; PNG_FILENAME</param>
                        </action>
                        <action disabled="1" id="-16" name="Wait" sid="484841093213604" type="System">
                            <param id="0" name="Seconds">2</param>
                        </action>
                        <action disabled="1" id="-9" name="Set value" sid="446014377354240" type="System">
                            <param id="0" name="Variable">done</param>
                            <param id="1" name="Value">1</param>
                        </action>
                        <action id="0" name="Call function" sid="527172927087543" type="Function">
                            <param id="0" name="Name">&quot;exit&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="554837381260762" title="cheat">
            <sub-events>
                <event-block sid="451211713308290">
                    <conditions>
                        <condition id="-18" name="Is in preview" sid="730126474773850" type="System" />
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="521841855575820">
                            <conditions>
                                <condition id="0" name="On key pressed" sid="380089761240922" type="Keyboard">
                                    <param id="0" name="Key">32</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="433836196348385" type="System">
                                    <param id="0" name="Variable">winState</param>
                                    <param id="1" name="Value">&quot;true&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="741483800449736">
                            <conditions>
                                <condition id="0" name="On key pressed" sid="603591060294792" type="Keyboard">
                                    <param id="0" name="Key">81</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="428078296723485" type="Function">
                                    <param id="0" name="Name">&quot;enlight&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="612555222100102">
                            <conditions>
                                <condition id="0" name="On key pressed" sid="623201575034978" type="Keyboard">
                                    <param id="0" name="Key">83</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="856223750006446" type="Function">
                                    <param id="0" name="Name">&quot;screenshot&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="958052969531282" title="couleurs qui changent">
            <sub-events>
                <variable constant="0" name="hue" sid="442149292479677" static="1" type="number">0</variable>
                <variable constant="0" name="saturation" sid="536248255835100" static="1" type="number">0</variable>
                <variable constant="0" name="luminosity" sid="142593499357789" static="1" type="number">0</variable>
                <event-block sid="839016562725084">
                    <conditions>
                        <condition id="0" name="On function" sid="371761618079453" type="Function">
                            <param id="0" name="Name">&quot;change colors&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="929485088794821">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="700295426609075" type="System">
                                    <param id="0" name="Variable">hue</param>
                                    <param id="1" name="Value">(((level-1) *3) %100) -100</param>
                                </action>
                                <action id="-9" name="Set value" sid="734962051882720" type="System">
                                    <param id="0" name="Variable">saturation</param>
                                    <param id="1" name="Value">100</param>
                                </action>
                                <action id="-9" name="Set value" sid="933468908191257" type="System">
                                    <param id="0" name="Variable">luminosity</param>
                                    <param id="1" name="Value">100+ (level-1) * 1.4</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="717731802003470">
                            <conditions />
                            <actions>
                                <action id="-32" name="Set layer effect parameter" sid="699755616405912" type="System">
                                    <param id="0" name="Layer">&quot;game&quot;</param>
                                    <param id="1" name="Effect">&quot;AdjustHSL&quot;</param>
                                    <param id="2" name="Parameter index">0</param>
                                    <param id="3" name="Value">hue</param>
                                </action>
                                <action id="-32" name="Set layer effect parameter" sid="637185429314227" type="System">
                                    <param id="0" name="Layer">&quot;game&quot;</param>
                                    <param id="1" name="Effect">&quot;AdjustHSL&quot;</param>
                                    <param id="2" name="Parameter index">1</param>
                                    <param id="3" name="Value">saturation</param>
                                </action>
                                <action id="-32" name="Set layer effect parameter" sid="379754616699665" type="System">
                                    <param id="0" name="Layer">&quot;game&quot;</param>
                                    <param id="1" name="Effect">&quot;AdjustHSL&quot;</param>
                                    <param id="2" name="Parameter index">2</param>
                                    <param id="3" name="Value">luminosity</param>
                                </action>
                                <action id="0" name="Call function" sid="313923941361421" type="Function">
                                    <param id="0" name="Name">&quot;log&quot;</param>
                                    <param id="1" name="Parameter {n}">&quot;adjusting colors: &quot; &amp; hue &amp; &quot;, &quot; &amp; saturation &amp; &quot;, &quot; &amp; luminosity</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="834150883673432" title="Log">
            <sub-events>
                <variable comment="Maintain the log" constant="0" name="log" sid="513315077531989" static="1" type="text"></variable>
                <event-block sid="289526770799524">
                    <conditions>
                        <condition id="0" name="On function" sid="295932430243417" type="Function">
                            <param id="0" name="Name">&quot;log&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="t" sid="224480612893195" static="0" type="text"></variable>
                        <event-block sid="461966867188312">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="679345837672997" type="System">
                                    <param id="0" name="Variable">t</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="455292228933548">
                            <conditions />
                            <actions>
                                <action id="-10" name="Add to" sid="911314247227795" type="System">
                                    <param id="0" name="Variable">log</param>
                                    <param id="1" name="Value">t&amp;newline</param>
                                </action>
                                <action id="14" name="Log" sid="920042414648851" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">t</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="108393836858249" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">log</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="365743041526832">
                    <conditions>
                        <condition id="0" name="On function" sid="729002121411934" type="Function">
                            <param id="0" name="Name">&quot;log.save&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Write file" sid="906717965390532" type="NWjs">
                            <param id="0" name="Path">workfolder&amp;LOG_FILENAME</param>
                            <param id="1" name="Contents">log</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="113206237363517">
                    <conditions>
                        <condition id="-6" name="Every X seconds" sid="571685044953906" type="System">
                            <param id="0" name="Interval (seconds)">5</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="444344219648220" type="Function">
                            <param id="0" name="Name">&quot;log&quot;</param>
                            <param id="1" name="Parameter {n}">&quot;I still haven&apos;t quit, so i&apos;m gonna save the log&quot;</param>
                        </action>
                        <action id="0" name="Call function" sid="442953816339744" type="Function">
                            <param id="0" name="Name">&quot;log.save&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
